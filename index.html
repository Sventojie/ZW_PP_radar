<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„æ–°é—»åŠ©æ‰‹</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; font-family: sans-serif; }
        #app { width: 100%; height: 100vh; } /* å®¹å™¨åç§°å¿…é¡»ä¸å®˜æ–¹ä»£ç ä¸€è‡´ */
        #status {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        .loader {
            margin: 20px auto;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error { color: #dc3545; background-color: #f8d7da; padding: 20px; border-radius: 5px; margin: 20px; }
    </style>
</head>
<body>
    <!-- åŠ è½½çŠ¶æ€æç¤º -->
    <div id="status">
        <div class="loader"></div>
        <p>æ­£åœ¨åŠ è½½æ–°é—»åŠ©æ‰‹...</p>
    </div>
    <!-- åº”ç”¨å®¹å™¨ï¼Œåç§°å¿…é¡»ä¸º #app -->
    <div id="app"></div>

    <script>
        // ğŸ”§ ã€æ ¸å¿ƒé…ç½®åŒºã€‘å¿…é¡»å®Œå…¨æŒ‰ç…§ä½ ä»Cozeåå°è·å–çš„ä»£ç å¡«å†™
        const config = {
            token: 'sat_a8UX1YINH9dJ0fk1KY3y4mV48gVvxUDPMX6P87MAIU9UEgYXN7VzwurZcaeX8zYH', // âš ï¸ è¯·æ›¿æ¢æˆä½ ä»Cozeåå°è·å¾—çš„å®Œæ•´ tokenï¼ˆä»¥ pat_ å¼€å¤´çš„é•¿å­—ç¬¦ä¸²ï¼‰
            appId: '7595139747782737947', // ä½ çš„ App ID / Bot ID
            container: '#app',
            userInfo: {
                id: '',
                url: '',
                nickname: 'ç”¨æˆ·' // å¯ä»¥è‡ªå®šä¹‰é»˜è®¤ç”¨æˆ·å
            }
        };

        // åŠ¨æ€åŠ è½½å®˜æ–¹æŒ‡å®šçš„SDK
        var webSdkScript = document.createElement('script');
        webSdkScript.src = 'https://lf-cdn.coze.cn/obj/unpkg/flow-platform/builder-web-sdk/0.1.1-beta.1/dist/umd/index.js';
        
        // è®¾ç½®åŠ è½½è¶…æ—¶ï¼ˆ30ç§’ï¼‰
        const loadTimeout = 30000;
        const timeoutId = setTimeout(() => {
            document.getElementById('status').innerHTML = '<div class="error">åŠ è½½è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–åˆ·æ–°é¡µé¢ã€‚</div>';
        }, loadTimeout);

        // SDKåŠ è½½æˆåŠŸåçš„å›è°ƒ
        webSdkScript.onload = function () {
            clearTimeout(timeoutId); // æ¸…é™¤è¶…æ—¶è®¡æ—¶å™¨
            
            // æ£€æŸ¥å¿…è¦çš„é…ç½®
            if (!config.token || config.token.includes('*')) {
                document.getElementById('status').innerHTML = '<div class="error">è¯·å…ˆåœ¨ä»£ç ä¸­å¡«å†™æ­£ç¡®çš„ tokenã€‚</div>';
                console.error('Token æœªé…ç½®æˆ–ä»ä¸ºå ä½ç¬¦ã€‚');
                return;
            }
            if (typeof CozeWebSDK === 'undefined') {
                document.getElementById('status').innerHTML = '<div class="error">SDK åŠ è½½å¼‚å¸¸ã€‚</div>';
                return;
            }

            try {
                // ğŸ¯ å…³é”®æ­¥éª¤ï¼šä½¿ç”¨å®˜æ–¹æ­£ç¡®çš„ API åˆå§‹åŒ–åº”ç”¨
                new CozeWebSDK.AppWebSDK(config);
                // åˆå§‹åŒ–è°ƒç”¨æˆåŠŸï¼Œéšè—åŠ è½½çŠ¶æ€ï¼ˆåº”ç”¨ç•Œé¢ä¼šè‡ªè¡Œå¡«å…… #app å®¹å™¨ï¼‰
                document.getElementById('status').style.display = 'none';
                console.log('Coze åº”ç”¨åˆå§‹åŒ–è°ƒç”¨æˆåŠŸã€‚');
            } catch (error) {
                document.getElementById('status').innerHTML = `<div class="error">åˆå§‹åŒ–å¤±è´¥ï¼š${error.message}</div>`;
                console.error('åˆå§‹åŒ–å¼‚å¸¸:', error);
            }
        };

        // SDKåŠ è½½å¤±è´¥çš„å›è°ƒ
        webSdkScript.onerror = function () {
            clearTimeout(timeoutId);
            document.getElementById('status').innerHTML = '<div class="error">åŠ è½½ SDK å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åé‡è¯•ã€‚</div>';
        };

        // å¼€å§‹åŠ è½½SDK
        document.head.appendChild(webSdkScript);
    </script>
</body>
</html>
