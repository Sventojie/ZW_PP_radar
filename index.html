<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AEC事业群产品规划部-市场洞察雷达</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; font-family: sans-serif; }
        #app { width: 100%; height: 100vh; } 
        #status {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        .loader {
            margin: 20px auto;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error { color: #dc3545; background-color: #f8d7da; padding: 20px; border-radius: 5px; margin: 20px; }
    </style>
</head>
<body>
    <!-- 加载状态提示 -->
    <div id="status">
        <div class="loader"></div>
        <p>正在加载新闻助手...</p>
    </div>
    <!-- 应用容器，名称必须为 #app -->
    <div id="app"></div>

    <script>
        const config = {
            token: 'sat_a8UX1YINH9dJ0fk1KY3y4mV48gVvxUDPMX6P87MAIU9UEgYXN7VzwurZcaeX8zYH', 
            appId: '7595139747782737947', 
            container: '#app',
            userInfo: {
                id: '',
                url: '',
                nickname: '用户' 
            }
        };

        // 动态加载SDK
        var webSdkScript = document.createElement('script');
        webSdkScript.src = 'https://lf-cdn.coze.cn/obj/unpkg/flow-platform/builder-web-sdk/0.1.1-beta.1/dist/umd/index.js';
        
        // 设置加载超时（30秒）
        const loadTimeout = 30000;
        const timeoutId = setTimeout(() => {
            document.getElementById('status').innerHTML = '<div class="error">加载超时，请检查网络或刷新页面。</div>';
        }, loadTimeout);

        // SDK加载成功后的回调
        webSdkScript.onload = function () {
            clearTimeout(timeoutId); // 清除超时计时器
            
            // 检查必要的配置
            if (!config.token || config.token.includes('*')) {
                document.getElementById('status').innerHTML = '<div class="error">请先在代码中填写正确的 token。</div>';
                console.error('Token 未配置或仍为占位符。');
                return;
            }
            if (typeof CozeWebSDK === 'undefined') {
                document.getElementById('status').innerHTML = '<div class="error">SDK 加载异常。</div>';
                return;
            }

            try {
                // API 初始化
                new CozeWebSDK.AppWebSDK(config);
                // 初始化调用成功，隐藏加载状态
                document.getElementById('status').style.display = 'none';
                console.log('Coze 应用初始化调用成功。');
            } catch (error) {
                document.getElementById('status').innerHTML = `<div class="error">初始化失败：${error.message}</div>`;
                console.error('初始化异常:', error);
            }
        };

        // SDK加载失败回调
        webSdkScript.onerror = function () {
            clearTimeout(timeoutId);
            document.getElementById('status').innerHTML = '<div class="error">加载 SDK 失败，请检查网络或稍后重试。</div>';
        };

        // 开始加载SDK
        document.head.appendChild(webSdkScript);
    </script>
</body>
</html>

